{
  "$schema": "../../src/schemas/workflow.schema.json",
  "name": "europass",
  "description": "",
  "version": "1.0.0",
  "target": {
    "url": "https://europass.europa.eu/fr/find-jobs?keyword=developer+internship&location=&order=relevance&op=Trouver&form_build_id=form-Sefco5bqvsSNJRAsY8Mq5VEED25AZoJeapBkuntl9hE&form_id=jobs_search"
  },
  "browser": {
    "type": "chromium",
    "headless": true,
    "timeout": 30000,
    "viewport": {
      "width": 1920,
      "height": 1080
    }
  },
  "logging": {
    "level": "info",
    "console": true
  },
  "errorHandling": {
    "retries": 3,
    "retryDelay": 1000,
    "screenshotOnError": true,
    "continueOnError": false
  },
  "scheduling": {
    "enabled": false,
    "cron": "",
    "timezone": "Europe/Paris"
  },
  "output": {
    "format": "csv",
    "path": "./output",
    "append": false,
    "createPath": true,
    "json": {
      "pretty": true
    },
    "csv": {
      "delimiter": ";",
      "includeHeaders": true,
      "encoding": "utf8"
    },
    "columns": [
      "title",
      "company",
      "location",
      "description",
      "url"
    ]
  },
  "workflows": [
    {
      "name": "main",
      "steps": [
        {
          "id": "step-0",
          "name": "navigate - 0",
          "type": "navigate",
          "config": {
            "url": "{{target.url}}",
            "waitUntil": "networkidle"
          },
          "next": "step-1"
        },
        {
          "id": "step-1",
          "name": "wait - 1",
          "type": "wait",
          "config": {
            "time": 3000
          },
          "next": "step-2"
        },
        {
          "id": "step-2",
          "name": "scroll - 2",
          "type": "scroll",
          "config": {
            "direction": "down",
            "pixels": 500
          },
          "next": "extract-data"
        },
        {
          "id": "extract-data",
          "name": "extract-data",
          "type": "extract",
          "config": {
            "container": ".views-element-container > .row",
            "multiple": true,
            "fields": [
              {
                "name": "title",
                "selector": ".jobs--title",
                "type": "text"
              },
              {
                "name": "company",
                "selector": ".jobs--subtitle",
                "type": "text"
              },
              {
                "name": "location",
                "selector": ".field-item",
                "type": "text"
              },
              {
                "name": "description",
                "selector": ".field-item__description",
                "type": "text"
              },
              {
                "name": "url",
                "selector": ".boxButtonslist a:nth-child(2)",
                "type": "attribute",
                "attribute": "href"
              }
            ]
          },
          "output": "europass",
          "next": "step-4"
        },
        {
          "id": "step-4",
          "name": "pagination - 4",
          "type": "pagination",
          "config": {
            "type": "click",
            "nextSelector": ".ecl-pagination__item--next a",
            "maxPages": 2,
            "waitAfterClick": 3000,
            "repeatSteps": [
              "extract-data"
            ]
          }
        }
      ]
    }
  ]
}